const DATA_SOURCES={items:items,bows:bows,arrows:arrows,tableList:tableList};function formatNumber(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function parseForSorting(e){const t=parseFloat(e);return isNaN(t)?"string"==typeof e?e.toLowerCase():e||0:t}const TABLE_CONFIGS={default:{dataSource:{source:"items",filter:(e,t)=>{const n=e.type&&e.type.includes("Equipment-")?e.type.split("Equipment-")[1]:e.type;return n&&n.toLowerCase()===t.toLowerCase()&&!TABLE_CONFIGS[n.toLowerCase()]}},columns:[{header:"Item",width:"25%",source:"items",field:"name",render:e=>`\n          <div class="item-container font-medium w-full">\n              <img src="drawable/${e.icon}.png" alt="${e.name}" class="w-12 h-12 mr-2">\n              <div align="center" class="text-center w-full">\n                  ${e.name}\n                  ${"Common"!==e.rarity?`<div class="ml-2 text-sm text-gray-500">(${e.rarity})</div>`:""}\n              </div>\n          </div>\n        `},{header:"Attack",width:"8%",align:"center",source:"items",field:"attackBonus"},{header:"Strength",width:"8%",align:"center",source:"items",field:"strengthBonus"},{header:"Defence",width:"8%",align:"center",source:"items",field:"defenceBonus"},{header:"Health",width:"8%",align:"center",source:"items",field:"healthBonus"},{header:"Details",width:"33%",source:"items",domSortSelector:".sortval",render:e=>{const t=parseInt(e.value)||0;return`\n            <div>\n              ${e.description&&"null"!==e.description?`<span class="text-gray-300">\n                      ${e.description}\n                     </span>`:""}\n              ${t>0?`<div class="text-sm text-gray-500">\n                       Value: \n                       <span \n                          class="sortval" \n                          data-sort-val="${t}"\n                       >\n                          ${formatNumber(t)}\n                       </span>\n                     </div>`:""}\n            </div>\n          `}}]},weapon:{dataSource:{source:"items",filter:e=>{if(e.type&&e.type.toLowerCase().includes("equipment-weapon")){return!bows.some((t=>t.name===e.name))}return!1}},columns:[{header:"Item",width:"25%",source:"items",field:"name",render:e=>`\n          <div class="item-container font-medium w-full">\n              <img src="drawable/${e.icon}.png" alt="${e.name}" class="w-12 h-12 mr-2">\n              <div align="center" class="text-center w-full">\n                  ${e.name}\n                  ${"Common"!==e.rarity?`<div class="ml-2 text-sm text-gray-500">(${e.rarity})</div>`:""}\n              </div>\n          </div>\n        `},{header:"Attack",width:"8%",align:"center",source:"items",field:"attackBonus"},{header:"Strength",width:"8%",align:"center",source:"items",field:"strengthBonus"},{header:"Defence",width:"8%",align:"center",source:"items",field:"defenceBonus"},{header:"Health",width:"8%",align:"center",source:"items",field:"healthBonus"},{header:"Details",width:"33%",source:"items",domSortSelector:".sortval",render:e=>{const t=parseInt(e.value)||0;return`\n            ${e.description&&"null"!==e.description?`<span class="text-gray-300">\n                    ${e.description}\n                   </span>`:""}\n            <div>\n              ${t>0?`<div class="text-sm text-gray-500">\n                       Value: \n                       <span\n                         class="sortval" \n                         data-sort-val="${t}"\n                       >\n                         ${formatNumber(t)}\n                       </span>\n                     </div>`:""}\n            </div>\n          `}}]},bow:{dataSource:{source:"bows",filter:()=>!0},columns:[{header:"Bow",width:"20%",source:"items",render:e=>`\n          <div class="item-container font-medium w-full">\n              <img src="drawable/${e.icon}.png" alt="${e.name}" class="w-12 h-12 mr-2">\n              <div align="center" class="text-center w-full">\n                  ${e.name}\n                  ${"Common"!==e.rarity?`<div class="ml-2 text-sm text-gray-500">(${e.rarity})</div>`:""}\n              </div>\n          </div>\n        `},{header:"Speed",width:"20%",align:"center",source:"bows",field:"speed"}]},arrows:{dataSource:{source:"arrows",filter:()=>!0},columns:[{header:"Arrows",width:"33%",source:"items",render:e=>`\n          <div class="item-container font-medium w-full">\n              <img src="drawable/${e.icon}.png" alt="${e.name}" class="w-12 h-12 mr-2">\n              <div align="center" class="text-center w-full">\n                  ${e.name}\n                  ${"Common"!==e.rarity?`<div class="ml-2 text-sm text-gray-500">(${e.rarity})</div>`:""}\n              </div>\n          </div>\n        `},{header:"Damage",width:"33%",align:"center",source:"arrows",field:"damage"},{header:"Details",width:"33%",source:"items",domSortSelector:".sortval",render:e=>{const t=parseInt(e.value)||0;return`\n            ${e.description&&"null"!==e.description?`<span class="text-gray-300">\n                     ${e.description}\n                   </span>`:""}\n            <div>\n              ${t>0?`<div class="text-sm text-gray-500">\n                       Value: \n                       <span\n                         class="sortval" \n                         data-sort-val="${t}"\n                       >\n                         ${formatNumber(t)}\n                       </span>\n                     </div>`:""}\n            </div>\n          `}}]}};class TableGenerator{constructor(){this.sortStates={}}getFilteredData(e,t){const n=e.dataSource;if(!n||!DATA_SOURCES[n.source])return[];const r=DATA_SOURCES[n.source];return"function"==typeof n.filter?r.filter((e=>n.filter(e,t))):r}getSortedData(e,t,n,r){if(-1===n.column)return e;const s=t.columns[n.column];if(!s)return e;if(s.field&&!s.domSortSelector)return[...e].sort(((e,t)=>{const r=parseForSorting(e[s.field]),a=parseForSorting(t[s.field]);return r<a?"asc"===n.direction?-1:1:r>a?"asc"===n.direction?1:-1:0}));if(s.domSortSelector&&r){const t=Array.from(r.querySelectorAll("tbody tr")),a=t.map((e=>{const t=e.querySelectorAll("td")[n.column];if(!t)return{row:e,sortValue:""};let r="";const a=t.querySelector(s.domSortSelector);if(a){const e=a.getAttribute("data-sort-val");r=parseForSorting(e||a.textContent)}return{row:e,sortValue:r}}));a.sort(((e,t)=>e.sortValue<t.sortValue?"asc"===n.direction?-1:1:e.sortValue>t.sortValue?"asc"===n.direction?1:-1:0));const o=r.querySelector("tbody");return a.forEach((e=>o.appendChild(e.row))),a.map((n=>e[t.indexOf(n.row)]))}return e}generateTable(e){const t=e.toLowerCase(),n=TABLE_CONFIGS[t]||TABLE_CONFIGS.default,r=this.sortStates[t]||{column:-1,direction:""};this.sortStates[t]=r;const s=this.getFilteredData(n,t),a=document.createElement("div");a.className="table-responsive";const o=`${t}-table`;return a.innerHTML=`\n      <table class="w-full border-collapse" id="${o}">\n        <thead>\n          <tr class="bg-gray-50">\n            ${this.generateHeaders(n,r)}\n          </tr>\n        </thead>\n        <tbody>\n          ${this.generateRows(n,s,r)}\n        </tbody>\n      </table>\n    `,this.attachSortHandlers(a,t,n),a}generateHeaders(e,t){return e.columns.map(((e,n)=>{let r="";return t.column===n&&(r="asc"===t.direction?" ↑":" ↓"),`\n          <th class="p-3 text-left border cursor-pointer" style="width: ${e.width}">\n            ${e.header}${r}\n          </th>\n        `})).join("")}generateRows(e,t,n){return this.getSortedData(t,e,n,null).map((t=>`<tr class="hover:bg-gray-50">${e.columns.map((n=>this.generateCell(n,t,e))).join("")}</tr>`)).join("")}generateCell(e,t,n){if(e.source&&e.source!==n.dataSource?.source){const n=DATA_SOURCES[e.source];if(n){const e=n.find((e=>e.name===t.name));e&&(t=e)}}if(e.render)return`<td class="p-3 border ${"center"===e.align?"text-center":""}">\n        ${e.render(t)}\n      </td>`;const r=e.field?t[e.field]:t.name;return`<td class="p-3 border ${"center"===e.align?"text-center":""}">\n      ${"number"==typeof r?formatNumber(r):r??""}\n    </td>`}attachSortHandlers(e,t,n){e.querySelector("table").querySelectorAll("th").forEach(((r,s)=>{r.addEventListener("click",(()=>{this.handleSort(t,s),this.updateTableBody(e,t,n),this.updateSortIndicators(e,n,t)}))}))}handleSort(e,t){this.sortStates[e]||(this.sortStates[e]={column:-1,direction:""});const n=this.sortStates[e];n.column===t?"desc"===n.direction?n.direction="asc":"asc"===n.direction&&(n.column=-1,n.direction=""):(n.column=t,n.direction="desc")}updateTableBody(e,t,n){const r=e.querySelector("table"),s=this.sortStates[t]||{column:-1,direction:""},a=this.getFilteredData(n,t),o=this.getSortedData(a,n,s,r),i=n.columns[s.column];i&&!i.domSortSelector&&(r.querySelector("tbody").innerHTML=o.map((e=>`<tr class="hover:bg-gray-50">${n.columns.map((t=>this.generateCell(t,e,n))).join("")}</tr>`)).join(""))}updateSortIndicators(e,t,n){const r=this.sortStates[n]||{column:-1,direction:""};e.querySelector("table").querySelectorAll("th").forEach(((e,n)=>{let s="";r.column===n&&(s="asc"===r.direction?" ↑":" ↓"),e.innerHTML=`${t.columns[n].header}${s}`}))}}const tableGen=new TableGenerator;function toggleSection(e){const t=document.getElementById(`section-${e.toLowerCase()}-content`),n=document.querySelector(`[data-section="${e}"]`);t.classList.contains("expanded")?(t.classList.remove("expanded"),n.classList.add("collapsed")):(t.classList.add("expanded"),n.classList.remove("collapsed"))}function populateTables(){const e=document.getElementById("sections");e.innerHTML="";const t=new Set(Object.keys(TABLE_CONFIGS)),n=new Map;items.forEach((e=>{let r=e.type&&e.type.includes("Equipment-")?e.type.split("Equipment-")[1]:e.type;r&&(r=r.toLowerCase(),t.has(r)||n.has(r)||n.set(r,{type:r,config:TABLE_CONFIGS.default}))})),Object.keys(TABLE_CONFIGS).forEach((e=>{"default"!==e&&n.set(e.toLowerCase(),{type:e,config:TABLE_CONFIGS[e]})}));Array.from(n.values()).sort(((e,t)=>e.type.localeCompare(t.type))).forEach((({type:t,config:n})=>{const r=document.createElement("div");r.className="section";const s=document.createElement("button");s.className="section-button collapsed",s.onclick=()=>toggleSection(t),s.setAttribute("data-section",t),s.textContent="null"===t.toLowerCase()?"Miscellaneous":t.toTitleCase();const a=document.createElement("div");a.id=`section-${t.toLowerCase()}-content`,a.className="section-content";const o=tableGen.generateTable(t);a.appendChild(o),r.appendChild(s),r.appendChild(a),e.appendChild(r)}))}String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},document.addEventListener("DOMContentLoaded",populateTables);